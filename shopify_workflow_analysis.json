{
  "workflow_id": "2rN72rtR8JAX9rV5",
  "name": "Shopify Occasions - Batch Update (Pagination 250)",
  "active": false,
  "nodes": [
    {
      "id": "manual-trigger",
      "name": "1Ô∏è‚É£ D√©marrage",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [240, 1504]
    },
    {
      "id": "init-pagination",
      "name": "2Ô∏è‚É£ Initialize Pagination",
      "type": "n8n-nodes-base.code",
      "position": [464, 1504]
    },
    {
      "id": "shopify-get-products",
      "name": "3Ô∏è‚É£ Shopify - Get 250 Products",
      "type": "n8n-nodes-base.shopify",
      "position": [688, 1504],
      "parameters": {
        "authentication": "oAuth2",
        "resource": "product",
        "operation": "getAll",
        "limit": 10
      },
      "credentials": {
        "shopifyOAuth2Api": {
          "id": "VniaQQuQc9LfrLh8",
          "name": "Shopify account"
        }
      }
    },
    {
      "id": "check-has-products",
      "name": "4Ô∏è‚É£ Has Products?",
      "type": "n8n-nodes-base.if",
      "position": [912, 1432]
    },
    {
      "id": "loop-products-in-batch",
      "name": "5Ô∏è‚É£ Loop Over Products",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [1136, 1312]
    },
    {
      "id": "extract-data",
      "name": "6Ô∏è‚É£ Extract Product Data",
      "type": "n8n-nodes-base.code",
      "position": [1360, 952]
    },
    {
      "id": "filter-products",
      "name": "7Ô∏è‚É£ Filtre Strict",
      "type": "n8n-nodes-base.if",
      "position": [1584, 952]
    },
    {
      "id": "build-prompt",
      "name": "8Ô∏è‚É£ Build AI Prompt",
      "type": "n8n-nodes-base.code",
      "position": [1808, 880]
    },
    {
      "id": "github-models-api",
      "name": "9Ô∏è‚É£ GitHub Copilot GPT-4",
      "type": "n8n-nodes-base.httpRequest",
      "position": [2032, 880],
      "parameters": {
        "method": "POST",
        "url": "https://models.inference.ai.azure.com/chat/completions"
      }
    },
    {
      "id": "parse-ai-response",
      "name": "üîü Parse AI Response",
      "type": "n8n-nodes-base.code",
      "position": [2256, 880]
    },
    {
      "id": "shopify-update-metafield",
      "name": "1Ô∏è‚É£1Ô∏è‚É£ Shopify - Update Occasions",
      "type": "n8n-nodes-base.httpRequest",
      "position": [2480, 880],
      "parameters": {
        "method": "POST",
        "url": "=https://luckybag-paris.myshopify.com/admin/api/2024-01/products/{{ $json.productId }}/metafields.json",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "shopifyOAuth2Api"
      },
      "credentials": {
        "shopifyOAuth2Api": {
          "id": "VniaQQuQc9LfrLh8",
          "name": "Shopify account"
        }
      }
    },
    {
      "id": "log-success",
      "name": "1Ô∏è‚É£2Ô∏è‚É£ Log Success",
      "type": "n8n-nodes-base.set",
      "position": [2704, 880]
    },
    {
      "id": "log-skip",
      "name": "1Ô∏è‚É£3Ô∏è‚É£ Log Skip",
      "type": "n8n-nodes-base.set",
      "position": [2704, 1072]
    },
    {
      "id": "merge-results",
      "name": "1Ô∏è‚É£4Ô∏è‚É£ Merge",
      "type": "n8n-nodes-base.merge",
      "position": [2928, 952]
    },
    {
      "id": "update-pagination",
      "name": "1Ô∏è‚É£5Ô∏è‚É£ Update Pagination State",
      "type": "n8n-nodes-base.code",
      "position": [1360, 1288]
    },
    {
      "id": "check-continue-loop",
      "name": "1Ô∏è‚É£6Ô∏è‚É£ Continue Loop?",
      "type": "n8n-nodes-base.if",
      "position": [1584, 1288]
    },
    {
      "id": "final-summary",
      "name": "1Ô∏è‚É£7Ô∏è‚É£ Final Summary",
      "type": "n8n-nodes-base.set",
      "position": [1808, 1408]
    },
    {
      "id": "wait-product-rate-limit",
      "name": "‚è±Ô∏è Wait (0.05s per product)",
      "type": "n8n-nodes-base.wait",
      "position": [3152, 1192]
    },
    {
      "id": "wait-batch-rate-limit",
      "name": "‚è±Ô∏è Wait (1s between batches)",
      "type": "n8n-nodes-base.wait",
      "position": [1808, 1216]
    }
  ],
  "connections": {
    "1Ô∏è‚É£ D√©marrage": ["2Ô∏è‚É£ Initialize Pagination"],
    "2Ô∏è‚É£ Initialize Pagination": ["3Ô∏è‚É£ Shopify - Get 250 Products"],
    "3Ô∏è‚É£ Shopify - Get 250 Products": ["4Ô∏è‚É£ Has Products?"],
    "4Ô∏è‚É£ Has Products?": ["5Ô∏è‚É£ Loop Over Products", "1Ô∏è‚É£7Ô∏è‚É£ Final Summary"],
    "5Ô∏è‚É£ Loop Over Products": ["1Ô∏è‚É£5Ô∏è‚É£ Update Pagination State", "6Ô∏è‚É£ Extract Product Data"],
    "6Ô∏è‚É£ Extract Product Data": ["7Ô∏è‚É£ Filtre Strict"],
    "7Ô∏è‚É£ Filtre Strict": ["8Ô∏è‚É£ Build AI Prompt", "1Ô∏è‚É£3Ô∏è‚É£ Log Skip"],
    "8Ô∏è‚É£ Build AI Prompt": ["9Ô∏è‚É£ GitHub Copilot GPT-4"],
    "9Ô∏è‚É£ GitHub Copilot GPT-4": ["üîü Parse AI Response"],
    "üîü Parse AI Response": ["1Ô∏è‚É£1Ô∏è‚É£ Shopify - Update Occasions"],
    "1Ô∏è‚É£1Ô∏è‚É£ Shopify - Update Occasions": ["1Ô∏è‚É£2Ô∏è‚É£ Log Success"],
    "1Ô∏è‚É£2Ô∏è‚É£ Log Success": ["1Ô∏è‚É£4Ô∏è‚É£ Merge"],
    "1Ô∏è‚É£3Ô∏è‚É£ Log Skip": ["1Ô∏è‚É£4Ô∏è‚É£ Merge"],
    "1Ô∏è‚É£4Ô∏è‚É£ Merge": ["‚è±Ô∏è Wait (0.05s per product)"],
    "1Ô∏è‚É£5Ô∏è‚É£ Update Pagination State": ["1Ô∏è‚É£6Ô∏è‚É£ Continue Loop?"],
    "1Ô∏è‚É£6Ô∏è‚É£ Continue Loop?": ["‚è±Ô∏è Wait (1s between batches)", "1Ô∏è‚É£7Ô∏è‚É£ Final Summary"],
    "‚è±Ô∏è Wait (0.05s per product)": ["5Ô∏è‚É£ Loop Over Products"],
    "‚è±Ô∏è Wait (1s between batches)": ["3Ô∏è‚É£ Shopify - Get 250 Products"]
  }
}
